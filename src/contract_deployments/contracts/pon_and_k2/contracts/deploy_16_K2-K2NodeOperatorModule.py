from web3 import Web3
from web3.middleware import construct_sign_and_send_raw_middleware
import os
import time
import logging

# Account Alias: PON
ACCOUNT_ALIAS = "PON"

# K2NodeOperatorModule contract bytecode
BYTE_CODE = "0x60a060405230608052600a610108553480156200001b57600080fd5b50620000266200002c565b620000ed565b600054610100900460ff1615620000995760405162461bcd60e51b815260206004820152602760248201527f496e697469616c697a61626c653a20636f6e747261637420697320696e697469604482015266616c697a696e6760c81b606482015260840160405180910390fd5b60005460ff90811614620000eb576000805460ff191660ff9081179091556040519081527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b565b60805161538e6200012560003960008181611371015281816113b101528181611450015281816114900152611729015261538e6000f3fe6080604052600436106103ad5760003560e01c80638911a89e116101e7578063bdd007f71161010d578063e4e96ec8116100a0578063f486f6711161006f578063f486f67114610bd6578063f8b74cde14610bf7578063ff931bfb14610c17578063ffb8808914610c3757600080fd5b8063e4e96ec814610b61578063ed24911d14610b81578063f2fde38b14610b96578063f38f65eb14610bb657600080fd5b8063ccad973d116100dc578063ccad973d14610aae578063da6342df14610ace578063dd98bbc314610b0a578063dfb63eea14610b4157600080fd5b8063bdd007f714610a37578063bed9833414610a57578063c0e6870a14610a77578063c307cc5114610a8e57600080fd5b806397439c6111610185578063a716ccec11610154578063a716ccec14610998578063aa8775a6146109b8578063b50c46ab146109e9578063b707e07814610a0957600080fd5b806397439c61146108f957806398f640f21461092a578063a6f369d514610958578063a712ae911461097857600080fd5b806393b9b375116101c157806393b9b3751461087157806395e97eee146108a257806396415901146108c357806396471ee8146108d957600080fd5b80638911a89e146108135780638da5cb5b14610833578063913d00821461085157600080fd5b80634f1ef286116102d7578063715018a61161026a5780638486e0d9116102395780638486e0d91461078a57806384b0196e146107ab57806385a5b939146107d357806386ca253f146107f357600080fd5b8063715018a61461070d57806376628cc0146107225780637ec2e278146107535780637f468d3f1461077357600080fd5b806360cb60c3116102a657806360cb60c31461067657806367a89d861461069657806368ed9a0d146106cd5780636dde59a2146106ed57600080fd5b80634f1ef286146106175780634f9a36231461062a57806352d1902d1461064a578063574be3251461065f57600080fd5b8063283409d11161034f57806331e239b61161031e57806331e239b61461058f5780633659cfe6146105a857806338e135b3146105c85780634af3b245146105f657600080fd5b8063283409d1146104f157806328854b641461051157806329be199f1461053f5780632ec5a4121461055f57600080fd5b806317d1dd0e1161038b57806317d1dd0e1461045a5780631c191dff1461047c5780631fe17d551461049c578063258a7ba3146104d057600080fd5b80630a36bb30146103b25780630ed1dfc3146103f357806317bbc72714610421575b600080fd5b3480156103be57600080fd5b506103e06103cd36600461448d565b6101126020526000908152604090205481565b6040519081526020015b60405180910390f35b3480156103ff57600080fd5b506103e061040e36600461448d565b6101036020526000908152604090205481565b34801561042d57600080fd5b5061010c54610442906001600160a01b031681565b6040516001600160a01b0390911681526020016103ea565b34801561046657600080fd5b5061047a61047536600461448d565b610c4d565b005b34801561048857600080fd5b5061047a6104973660046144aa565b610d17565b3480156104a857600080fd5b506103e07f04a75c8b9741e8ec6ff1720d6953386db151745af0dd6ef856403ae085ccf18c81565b3480156104dc57600080fd5b5061010954610442906001600160a01b031681565b3480156104fd57600080fd5b5061047a61050c3660046144d6565b610f84565b34801561051d57600080fd5b506103e061052c36600461448d565b6101116020526000908152604090205481565b34801561054b57600080fd5b5061047a61055a3660046145f0565b611073565b34801561056b57600080fd5b5061057f61057a366004614660565b611261565b60405190151581526020016103ea565b34801561059b57600080fd5b506103e064077359400081565b3480156105b457600080fd5b5061047a6105c336600461448d565b611367565b3480156105d457600080fd5b506103e06105e336600461448d565b6101046020526000908152604090205481565b34801561060257600080fd5b5061010b54610442906001600160a01b031681565b61047a6106253660046146c8565b611446565b34801561063657600080fd5b5061047a610645366004614660565b611516565b34801561065657600080fd5b506103e061171c565b34801561066b57600080fd5b506103e06101015481565b34801561068257600080fd5b5061047a61069136600461475a565b6117cf565b3480156106a257600080fd5b506104426106b136600461448d565b61010a602052600090815260409020546001600160a01b031681565b3480156106d957600080fd5b5061047a6106e83660046144d6565b61199c565b3480156106f957600080fd5b5061047a610708366004614660565b6119d7565b34801561071957600080fd5b5061047a611c57565b34801561072e57600080fd5b5061057f61073d3660046144d6565b6101146020526000908152604090205460ff1681565b34801561075f57600080fd5b5061047a61076e3660046147d8565b611c6b565b34801561077f57600080fd5b506103e06101005481565b34801561079657600080fd5b5061010554610442906001600160a01b031681565b3480156107b757600080fd5b506107c0611c9e565b6040516103ea9796959493929190614861565b3480156107df57600080fd5b5061047a6107ee3660046148f7565b611d3c565b3480156107ff57600080fd5b5061047a61080e3660046144d6565b611f05565b34801561081f57600080fd5b5061047a61082e366004614660565b6121af565b34801561083f57600080fd5b506068546001600160a01b0316610442565b34801561085d57600080fd5b5061047a61086c366004614a21565b612364565b34801561087d57600080fd5b5061057f61088c36600461448d565b61010d6020526000908152604090205460ff1681565b3480156108ae57600080fd5b5061010654610442906001600160a01b031681565b3480156108cf57600080fd5b506103e060ff5481565b3480156108e557600080fd5b5061057f6108f43660046148f7565b61249d565b34801561090557600080fd5b5061057f61091436600461448d565b6101026020526000908152604090205460ff1681565b34801561093657600080fd5b506103e06109453660046144d6565b61010f6020526000908152604090205481565b34801561096457600080fd5b506103e0610973366004614ab4565b6124f2565b34801561098457600080fd5b5061047a610993366004614aff565b612572565b3480156109a457600080fd5b5061047a6109b3366004614b6a565b6126f9565b3480156109c457600080fd5b5061057f6109d33660046144d6565b6101136020526000908152604090205460ff1681565b3480156109f557600080fd5b5061047a610a0436600461448d565b61291e565b348015610a1557600080fd5b506103e0610a2436600461448d565b6101106020526000908152604090205481565b348015610a4357600080fd5b5061047a610a5236600461448d565b612949565b348015610a6357600080fd5b5061047a610a723660046144d6565b612b28565b348015610a8357600080fd5b506103e06101085481565b348015610a9a57600080fd5b5061047a610aa93660046144aa565b612b63565b348015610aba57600080fd5b5061047a610ac93660046144aa565b612c88565b348015610ada57600080fd5b5061057f610ae93660046144aa565b61010e60209081526000928352604080842090915290825290205460ff1681565b348015610b1657600080fd5b50610442610b2536600461448d565b610115602052600090815260409020546001600160a01b031681565b348015610b4d57600080fd5b5061047a610b5c3660046144aa565b612d8b565b348015610b6d57600080fd5b5061047a610b7c3660046147d8565b61304c565b348015610b8d57600080fd5b506103e06131d5565b348015610ba257600080fd5b5061047a610bb136600461448d565b6131e4565b348015610bc257600080fd5b5061047a610bd13660046147d8565b61325a565b348015610be257600080fd5b5061010754610442906001600160a01b031681565b348015610c0357600080fd5b5061047a610c123660046144aa565b6134ff565b348015610c2357600080fd5b5061047a610c3236600461448d565b61370f565b348015610c4357600080fd5b506103e060fe5481565b33600090815261010d602052604090205460ff16610c9c5760405162461bcd60e51b81526020600482015260076024820152664e6f7420504e4f60c81b60448201526064015b60405180910390fd5b6001600160a01b038116610ce75760405162461bcd60e51b815260206004820152601260248201527116995c9bc8199959481c9958da5c1a595b9d60721b6044820152606401610c93565b3360009081526101156020526040902080546001600160a01b0319166001600160a01b0392909216919091179055565b61010b546001600160a01b0316610d695760405162461bcd60e51b81526020600482015260166024820152752932b232b632b3b0ba34b7b739903737ba1037b832b760511b6044820152606401610c93565b6001600160a01b038216600090815261010d602052604090205460ff16610dc05760405162461bcd60e51b815260206004820152600b60248201526a496e76616c696420504e4f60a81b6044820152606401610c93565b633b9aca008111610de35760405162461bcd60e51b8152600401610c9390614c0e565b61010b5433600090815261010a60205260409020546001600160a01b03908116911614610e525760405162461bcd60e51b815260206004820152601a60248201527f526564656c65676174696f6e207265717569726573206c69656e0000000000006044820152606401610c93565b3360009081526101116020908152604080832054610110909252822054610e799190614c42565b3360009081526101046020526040902054909150610ea09068014d1120d7b1600000614c55565b610eaa8284614c6c565b1115610ef85760405162461bcd60e51b815260206004820152601f60248201527f526564656c65676174696f6e2065786365656473204e442062616c616e6365006044820152606401610c93565b336000908152610110602052604081208054849290610f18908490614c6c565b90915550506001600160a01b0383166000908152610112602052604081208054849290610f46908490614c6c565b90915550506040516001600160a01b038416907f7f08121aa6ae502f764c7c1d7f883752013bf3703674f3ed681887141e8aa13090600090a2505050565b6068546001600160a01b0316331480611025575061010660009054906101000a90046001600160a01b03166001600160a01b0316632131c68c6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610fec573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906110109190614c7f565b6001600160a01b0316336001600160a01b0316145b6110415760405162461bcd60e51b8152600401610c9390614c9c565b6101088190556040517fe78a4723ed628a50f8310a41cb645c0e762ce6d9908b1c3ee99a475a889f23c490600090a150565b61107f8484848461249d565b6110bc5760405162461bcd60e51b815260206004820152600e60248201526d125b9d985b1a59081c995c1bdc9d60921b6044820152606401610c93565b60006110c786613817565b336000908152610111602090815260408083205461011090925282205492935090916110f39190614c42565b336000908152610104602052604090205490915068014d1120d7b160000090829061111e9083614c55565b6111289190614c42565b10156111765760405162461bcd60e51b815260206004820152601760248201527f546f6f206d616e792072652d64656c65676174696f6e730000000000000000006044820152606401610c93565b64077359400084106111f0576101065460405163851ccd8360e01b81526001600160a01b039091169063851ccd83906111b990859033908b908b90600401614ce7565b600060405180830381600087803b1580156111d357600080fd5b505af11580156111e7573d6000803e3d6000fd5b50505050611258565b61010654604051631ec5eb7560e11b81526001600160a01b0390911690633d8bd6ea906112259033908a908a90600401614d14565b600060405180830381600087803b15801561123f57600080fd5b505af1158015611253573d6000803e3d6000fd5b505050505b50505050505050565b60008060fe546101015460016112779190614c6c565b118015915061128a576001915050611361565b61010554604051632218ef1d60e01b81526000916001600160a01b031690632218ef1d906112be9088908890600401614d39565b61010060405180830381865afa1580156112dc573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906113009190614d4d565b5050506001600160a01b0381166000908152610102602052604090205490955060ff169350508215915061135c9050575060ff546001600160a01b03821660009081526101036020526040902054611359906001614c6c565b11155b925050505b92915050565b6001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001630036113af5760405162461bcd60e51b8152600401610c9390614ddf565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166113f8600080516020615312833981519152546001600160a01b031690565b6001600160a01b03161461141e5760405162461bcd60e51b8152600401610c9390614e2b565b61142781613882565b604080516000808252602082019092526114439183919061388a565b50565b6001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016300361148e5760405162461bcd60e51b8152600401610c9390614ddf565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166114d7600080516020615312833981519152546001600160a01b031690565b6001600160a01b0316146114fd5760405162461bcd60e51b8152600401610c9390614e2b565b61150682613882565b6115128282600161388a565b5050565b61010954604051630654521f60e41b81523360048201819052916001600160a01b03169063654521f090602401602060405180830381865afa158015611560573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906115849190614e77565b6115c15760405162461bcd60e51b815260206004820152600e60248201526d139bdd081c9959da5cdd195c995960921b6044820152606401610c93565b61010554604051632218ef1d60e01b81526000916001600160a01b031690632218ef1d906115f59087908790600401614d39565b61010060405180830381865afa158015611613573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906116379190614d4d565b5050955050505050508060ff166003148061165557508060ff166004145b8061166357508060ff166005145b6116af5760405162461bcd60e51b815260206004820152601c60248201527f4e6f74206578697465642070726f706f736572207265676973747279000000006044820152606401610c93565b61010654604051631ec5eb7560e11b81526001600160a01b0390911690633d8bd6ea906116e490859088908890600401614d14565b600060405180830381600087803b1580156116fe57600080fd5b505af1158015611712573d6000803e3d6000fd5b5050505050505050565b6000306001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016146117bc5760405162461bcd60e51b815260206004820152603860248201527f555550535570677261646561626c653a206d757374206e6f742062652063616c60448201527f6c6564207468726f7567682064656c656761746563616c6c00000000000000006064820152608401610c93565b5060008051602061531283398151915290565b600054610100900460ff16158080156117ef5750600054600160ff909116105b806118095750303b158015611809575060005460ff166001145b61186c5760405162461bcd60e51b815260206004820152602e60248201527f496e697469616c697a61626c653a20636f6e747261637420697320616c72656160448201526d191e481a5b9a5d1a585b1a5e995960921b6064820152608401610c93565b6000805460ff19166001179055801561188f576000805461ff0019166101001790555b6001600160a01b0385166118d45760405162461bcd60e51b815260206004820152600c60248201526b5a65726f206164647265737360a01b6044820152606401610c93565b61192560405180604001604052806016815260200175139bd91953dc195c985d1bdc93585b9859d95b595b9d60521b815250604051806040016040528060018152602001603160f81b8152506139f5565b61010980546001600160a01b0319166001600160a01b03871617905561194e878585858a613a26565b8015611258576000805461ff0019169055604051600181527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a150505050505050565b6119a4613c2a565b60fe81905560405181907f6279fe741d541897432284e3dbd6791a21cec3b8a896f7b1b5974b3adcd8d03690600090a250565b610106546001600160a01b03163314611a025760405162461bcd60e51b8152600401610c9390614e94565b61010554604051632218ef1d60e01b81526000916001600160a01b031690632218ef1d90611a369086908690600401614d39565b61010060405180830381865afa158015611a54573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611a789190614d4d565b5050506001600160a01b03811660009081526101036020526040902054909550159350611ad892505050576001600160a01b038116600090815261010360205260408120805460019290611acd908490614c42565b90915550611af29050565b60016101016000828254611aec9190614c42565b90915550505b6001600160a01b038116600090815261010460205260408120805460019290611b1c908490614c42565b9250508190555060016101006000828254611b379190614c42565b9091555050610107546001600160a01b031615611c5257610107546001600160a01b038281166000908152610104602052604090819020546101005461010654925163e8ef91ed60e01b81529484169463ddf107eb948794169063e8ef91ed90611ba7908b908b90600401614d39565b602060405180830381865afa158015611bc4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611be89190614e77565b6040516001600160e01b031960e087901b1681526001600160a01b03909416600485015260248401929092526044830152151560648201526084015b600060405180830381600087803b158015611c3e57600080fd5b505af1158015611258573d6000803e3d6000fd5b505050565b611c5f613c2a565b611c696000613c84565b565b611c73613c2a565b6001600160a01b03919091166000908152603560205260409020805460ff1916911515919091179055565b6000606080600080600060606001546000801b148015611cbe5750600254155b611d025760405162461bcd60e51b81526020600482015260156024820152741152540dcc4c8e88155b9a5b9a5d1a585b1a5e9959605a1b6044820152606401610c93565b611d0a613cd6565b611d12613d68565b60408051600080825260208201909252600f60f81b9b939a50919850469750309650945092509050565b611d488484848461249d565b611d855760405162461bcd60e51b815260206004820152600e60248201526d125b9d985b1a59081c995c1bdc9d60921b6044820152606401610c93565b6407735940008210611dec5760405162461bcd60e51b815260206004820152602a60248201527f4566666563746976652062616c616e6365206d757374206265206c65737320746044820152690d0c2dc406664408aa8960b31b6064820152608401610c93565b61010954604051630654521f60e41b81523360048201819052916001600160a01b03169063654521f090602401602060405180830381865afa158015611e36573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611e5a9190614e77565b611e975760405162461bcd60e51b815260206004820152600e60248201526d139bdd081c9959da5cdd195c995960921b6044820152606401610c93565b61010654604051631ec5eb7560e11b81526001600160a01b0390911690633d8bd6ea90611ecc90849089908990600401614d14565b600060405180830381600087803b158015611ee657600080fd5b505af1158015611efa573d6000803e3d6000fd5b505050505050505050565b6101065460405163e1b1acb760e01b8152600481018390526000916001600160a01b03169063e1b1acb790602401600060405180830381865afa158015611f50573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052611f789190810190614ebd565b50979850506001600160a01b0388169650611fca955050505050505760405162461bcd60e51b815260206004820152600b60248201526a0496e76616c6964205342560ac1b6044820152606401610c93565b33600090815261010d602052604090205460ff1661201d5760405162461bcd60e51b815260206004820152601060248201526f4e6f7420504e4f20676c6f62616c6c7960801b6044820152606401610c93565b6000828152610113602052604090205460ff166120725760405162461bcd60e51b81526020600482015260136024820152726b4e6574776f726b206e6f742061637469766560681b6044820152606401610c93565b6000828152610114602052604090205460ff16156120c55760405162461bcd60e51b815260206004820152601060248201526f4e6f74206f70656e206e6574776f726b60801b6044820152606401610c93565b33600090815261010e6020908152604080832085845290915290205460ff161561212c5760405162461bcd60e51b8152602060048201526018602482015277416c726561647920504e4f20666f72206b4e6574776f726b60401b6044820152606401610c93565b33600090815261010e602090815260408083208584528252808320805460ff1916600190811790915561010f909252822080549192909161216e908490614c6c565b909155505060405160018152829033907f8a2a55a41da1c0585ffe214c2efc60e28e8481fef9781e6d3466529418ae48f49060200160405180910390a35050565b610106546001600160a01b031633146121da5760405162461bcd60e51b8152600401610c9390614e94565b61010554604051632218ef1d60e01b81526000916001600160a01b031690632218ef1d9061220e9086908690600401614d39565b61010060405180830381865afa15801561222c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906122509190614d4d565b50505094505050505060fe54610101540361229a576001600160a01b03811660009081526101036020526040812080546001929061228f908490614c6c565b909155506122b49050565b600161010160008282546122ae9190614c6c565b90915550505b6001600160a01b0381166000908152610104602052604081208054600192906122de908490614c6c565b92505081905550600161010060008282546122f99190614c6c565b9091555050610107546001600160a01b031615611c5257610107546001600160a01b03828116600081815261010460205260409081902054610100549151631820857760e31b815260048101939093526024830152604482015291169063c1042bb890606401611c24565b838061239c5760405162461bcd60e51b81526020600482015260076024820152664e6f206b65797360c81b6044820152606401610c93565b8083146123df5760405162461bcd60e51b8152602060048201526011602482015270496e636f6e73697374656e74206461746160781b6044820152606401610c93565b815181146124235760405162461bcd60e51b8152602060048201526011602482015270496e636f6e73697374656e74206461746160781b6044820152606401610c93565b60005b818110156112585761248d87878381811061244357612443614fac565b90506020028101906124559190614fc2565b87878581811061246757612467614fac565b9050602002013586858151811061248057612480614fac565b6020026020010151611d3c565b61249681615008565b9050612426565b6000806124ab8686866124f2565b9050603560006124c983866000015187602001518860400151613d77565b6001600160a01b0316815260208101919091526040016000205460ff169150505b949350505050565b6000807f04a75c8b9741e8ec6ff1720d6953386db151745af0dd6ef856403ae085ccf18c8585604051612526929190615021565b6040805191829003822060208301939093528101919091526060810184905260800160405160208183030381529060405280519060200120905061256981613d85565b95945050505050565b61257a613c2a565b82806125b75760405162461bcd60e51b815260206004820152600c60248201526b5a65726f207461726765747360a01b6044820152606401610c93565b8082146125d65760405162461bcd60e51b8152600401610c9390615031565b60005b818110156126f1578383828181106125f3576125f3614fac565b9050602002016020810190612608919061505e565b610102600088888581811061261f5761261f614fac565b9050602002016020810190612634919061448d565b6001600160a01b031681526020810191909152604001600020805460ff191691151591909117905583838281811061266e5761266e614fac565b9050602002016020810190612683919061505e565b151586868381811061269757612697614fac565b90506020020160208101906126ac919061448d565b6001600160a01b03167f9ae11a76b65952251b483aa9f12e46f005b4a12ff7faf6f4fe0d03884ce1607760405160405180910390a36126ea81615008565b90506125d9565b505050505050565b83806127335760405162461bcd60e51b81526020600482015260096024820152685a65726f206b65797360b81b6044820152606401610c93565b8083146127525760405162461bcd60e51b8152600401610c9390615031565b815181146127725760405162461bcd60e51b8152600401610c9390615031565b610106546001600160a01b03808916911663e99317dd888860008161279957612799614fac565b90506020028101906127ab9190614fc2565b6040518363ffffffff1660e01b81526004016127c8929190614d39565b602060405180830381865afa1580156127e5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906128099190614c7f565b6001600160a01b0316146128535760405162461bcd60e51b8152602060048201526011602482015270125b9d985b1a59081c9958da5c1a595b9d607a1b6044820152606401610c93565b600061285e88613817565b9050600061286c8686613db2565b91505080156128ac5760405162461bcd60e51b815260206004820152600c60248201526b4b69636b206f75747369646560a01b6044820152606401610c93565b6101065460405163345637b560e21b81526001600160a01b039091169063d158ded4906128e19085908c908c9060040161507b565b600060405180830381600087803b1580156128fb57600080fd5b505af115801561290f573d6000803e3d6000fd5b50505050505050505050505050565b612926613c2a565b61010780546001600160a01b0319166001600160a01b0392909216919091179055565b336001600160a01b038216036129a15760405162461bcd60e51b815260206004820152601d60248201527f44656c656761746f722063616e6e6f7420626520726563697069656e740000006044820152606401610c93565b33600090815261010a60205260409020546001600160a01b039081169082168103612a025760405162461bcd60e51b8152602060048201526011602482015270105b1c9958591e481c9958da5c1a595b9d607a1b6044820152606401610c93565b33600090815261010a6020526040902080546001600160a01b0319166001600160a01b0384811691909117909155811615612a8b57604051631d1a9d7560e31b81523360048201526001600160a01b0382169063e8d4eba890602401600060405180830381600087803b158015612a7857600080fd5b505af1925050508015612a89575060015b505b6001600160a01b03821615612aee576040516353246b6360e01b81523360048201526001600160a01b038316906353246b6390602401600060405180830381600087803b158015612adb57600080fd5b505af1925050508015612aec575060015b505b6040516001600160a01b0383169033907ffafe7d3935b3d477f54a95ec2b64a425faa83bb26b14a7ef796556780913eb4190600090a35050565b612b30613c2a565b60ff81905560405181907f473152c04e373cc2b92dc3bb1bd1e9825fb3320bc4617babbccfb48ee988bf4090600090a250565b60008111612b835760405162461bcd60e51b8152600401610c9390614c0e565b3360009081526101116020908152604080832054610110909252822054612baa9190614c42565b905081811015612bfc5760405162461bcd60e51b815260206004820152601960248201527f496e76616c69642062616c616e636520746f2072656d6f7665000000000000006044820152606401610c93565b336000908152610110602052604081208054849290612c1c908490614c42565b90915550506001600160a01b0383166000908152610112602052604081208054849290612c4a908490614c42565b90915550506040516001600160a01b038416907f170fbd009edfa810e486ca21d7bf38c1ffbaddee94da8aed34a649e3e0e7ad6c90600090a2505050565b610106546001600160a01b03163314612cb35760405162461bcd60e51b8152600401610c9390614e94565b6001600160a01b0382811660008181526101116020526040808220546101065491516370a0823160e01b81526004810194909452919391929116906370a0823190602401602060405180830381865afa158015612d14573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612d389190615129565b612d429190614c42565b905081811015611c525760405162461bcd60e51b81526020600482015260146024820152732932b6b7bb3290393296b232b632b3b0ba34b7b760611b6044820152606401610c93565b61010b546001600160a01b0316612ddd5760405162461bcd60e51b81526020600482015260166024820152752932b232b632b3b0ba34b7b739903737ba1037b832b760511b6044820152606401610c93565b6001600160a01b038216600090815261010d602052604090205460ff16612e345760405162461bcd60e51b815260206004820152600b60248201526a496e76616c696420504e4f60a81b6044820152606401610c93565b60008111612e545760405162461bcd60e51b8152600401610c9390614c0e565b61010b54610106546040516333d44ec360e11b81523360048201526001600160a01b0392831692909116906367a89d8690602401602060405180830381865afa158015612ea5573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612ec99190614c7f565b6001600160a01b031614612f1f5760405162461bcd60e51b815260206004820152601a60248201527f526564656c65676174696f6e207265717569726573206c69656e0000000000006044820152606401610c93565b336000908152610110602052604081208054839290612f3f908490614c6c565b9091555050336000908152610111602052604081208054839290612f64908490614c6c565b90915550506001600160a01b0382166000908152610112602052604081208054839290612f92908490614c6c565b9091555050610106546040516323b872dd60e01b8152336004820152306024820152604481018390526001600160a01b03909116906323b872dd906064016020604051808303816000875af1158015612fef573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906130139190614e77565b506040516001600160a01b038316907f7f08121aa6ae502f764c7c1d7f883752013bf3703674f3ed681887141e8aa13090600090a25050565b6068546001600160a01b03163314806130ed575061010660009054906101000a90046001600160a01b03166001600160a01b0316632131c68c6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156130b4573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906130d89190614c7f565b6001600160a01b0316336001600160a01b0316145b6131095760405162461bcd60e51b8152600401610c9390614c9c565b610108546001600160a01b0383166000908152610104602052604090205410156131755760405162461bcd60e51b815260206004820152601960248201527f4e6f74207265616368656420504e4f207468726573686f6c64000000000000006044820152606401610c93565b6001600160a01b038216600081815261010d6020908152604091829020805460ff191685151590811790915591519182527fa7205b80dc9185ac3c71a2b132888add2452db90bc99af9045fbdde828d931a7910160405180910390a25050565b60006131df613e1c565b905090565b6131ec613c2a565b6001600160a01b0381166132515760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b6064820152608401610c93565b61144381613c84565b6101065460405163aa6be30360e01b81523360048201819052916000916001600160a01b039091169063aa6be30390602401602060405180830381865afa1580156132a9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906132cd9190615129565b9050600081116133085760405162461bcd60e51b815260206004820152600660248201526504e6f205342560d41b6044820152606401610c93565b6001600160a01b038416600090815261010d602052604090205460ff166133645760405162461bcd60e51b815260206004820152601060248201526f4e6f7420504e4f20676c6f62616c6c7960801b6044820152606401610c93565b6000818152610113602052604090205460ff166133b95760405162461bcd60e51b81526020600482015260136024820152726b4e6574776f726b206e6f742061637469766560681b6044820152606401610c93565b6001600160a01b038416600090815261010e6020908152604080832084845290915290205460ff16156134295760405162461bcd60e51b8152602060048201526018602482015277416c726561647920504e4f20666f72206b4e6574776f726b60401b6044820152606401610c93565b6001600160a01b038416600090815261010e602090815260408083208484529091529020805460ff1916841580159190911790915561348d57600081815261010f60205260408120805460019290613482908490614c6c565b909155506134b39050565b600081815261010f602052604081208054600192906134ad908490614c42565b90915550505b80846001600160a01b03167f8a2a55a41da1c0585ffe214c2efc60e28e8481fef9781e6d3466529418ae48f4856040516134f1911515815260200190565b60405180910390a350505050565b6000811161351f5760405162461bcd60e51b8152600401610c9390614c0e565b336000908152610111602052604090205481111561357f5760405162461bcd60e51b815260206004820152601c60248201527f526564656c65676174696f6e20696e76616c69642062616c616e6365000000006044820152606401610c93565b6001600160a01b038216600090815261011260205260409020548111156135e85760405162461bcd60e51b815260206004820152601c60248201527f526564656c65676174696f6e20696e76616c69642062616c616e6365000000006044820152606401610c93565b336000908152610110602052604081208054839290613608908490614c42565b909155505033600090815261011160205260408120805483929061362d908490614c42565b90915550506001600160a01b038216600090815261011260205260408120805483929061365b908490614c42565b90915550506101065460405163a9059cbb60e01b8152336004820152602481018390526001600160a01b039091169063a9059cbb906044016020604051808303816000875af11580156136b2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906136d69190614e77565b506040516001600160a01b038316907f170fbd009edfa810e486ca21d7bf38c1ffbaddee94da8aed34a649e3e0e7ad6c90600090a25050565b6068546001600160a01b03163314806137b0575061010660009054906101000a90046001600160a01b03166001600160a01b0316632131c68c6040518163ffffffff1660e01b8152600401602060405180830381865afa158015613777573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061379b9190614c7f565b6001600160a01b0316336001600160a01b0316145b6137cc5760405162461bcd60e51b8152600401610c9390614c9c565b61010b80546001600160a01b0319166001600160a01b0383169081179091556040517fceeb35b8bb5e443da23ac81c4b4b04a7fbfedfe65237109a9f95d5a790e21eec90600090a250565b6001600160a01b03808216600090815261010a60205260408120549091168015611361576001600160a01b03811633146113615760405162461bcd60e51b815260206004820152600c60248201526b4e6f742064656c656761746560a01b6044820152606401610c93565b611443613c2a565b7f4910fdfa16fed3260ed0e7147f7cc6da11a60208b5b9406d12a635614ffd91435460ff16156138bd57611c5283613e26565b826001600160a01b03166352d1902d6040518163ffffffff1660e01b8152600401602060405180830381865afa925050508015613917575060408051601f3d908101601f1916820190925261391491810190615129565b60015b61397a5760405162461bcd60e51b815260206004820152602e60248201527f45524331393637557067726164653a206e657720696d706c656d656e7461746960448201526d6f6e206973206e6f74205555505360901b6064820152608401610c93565b60008051602061531283398151915281146139e95760405162461bcd60e51b815260206004820152602960248201527f45524331393637557067726164653a20756e737570706f727465642070726f786044820152681a58589b195555525160ba1b6064820152608401610c93565b50611c52838383613ec2565b600054610100900460ff16613a1c5760405162461bcd60e51b8152600401610c9390615142565b6115128282613eed565b600054610100900460ff16613a4d5760405162461bcd60e51b8152600401610c9390615142565b60008411613a975760405162461bcd60e51b81526020600482015260176024820152764d6178206e756d206f66206b657973206973207a65726f60481b6044820152606401610c93565b60008311613ae15760405162461bcd60e51b81526020600482015260176024820152764d6178206e756d206f66206b657973206973207a65726f60481b6044820152606401610c93565b6001600160a01b038216613b305760405162461bcd60e51b81526020600482015260166024820152755a65726f2070726f706f73657220726567697374727960501b6044820152606401610c93565b6001600160a01b038116613b785760405162461bcd60e51b815260206004820152600f60248201526e5a65726f204b32206c656e64696e6760881b6044820152606401610c93565b613b80613f3c565b613b88613f6b565b613b91856131e4565b60fe84905560ff83905561010580546001600160a01b038085166001600160a01b03199283161790925561010680549284169290911691909117905560405184907f6279fe741d541897432284e3dbd6791a21cec3b8a896f7b1b5974b3adcd8d03690600090a260405183907f473152c04e373cc2b92dc3bb1bd1e9825fb3320bc4617babbccfb48ee988bf4090600090a25050505050565b6068546001600160a01b03163314611c695760405162461bcd60e51b815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65726044820152606401610c93565b606880546001600160a01b038381166001600160a01b0319831681179093556040519116919082907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a35050565b606060038054613ce59061518d565b80601f0160208091040260200160405190810160405280929190818152602001828054613d119061518d565b8015613d5e5780601f10613d3357610100808354040283529160200191613d5e565b820191906000526020600020905b815481529060010190602001808311613d4157829003601f168201915b5050505050905090565b606060048054613ce59061518d565b600061256985858585613f92565b6000611361613d92613e1c565b8360405161190160f01b8152600281019290925260228201526042902090565b60008060005b83811015613e1457640773594000858583818110613dd857613dd8614fac565b9050602002013510613df657613def600184614c6c565b9250613e04565b613e01600183614c6c565b91505b613e0d81615008565b9050613db8565b509250929050565b60006131df613fba565b6001600160a01b0381163b613e935760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b6064820152608401610c93565b60008051602061531283398151915280546001600160a01b0319166001600160a01b0392909216919091179055565b613ecb8361402e565b600082511180613ed85750805b15611c5257613ee7838361406e565b50505050565b600054610100900460ff16613f145760405162461bcd60e51b8152600401610c9390615142565b6003613f20838261520d565b506004613f2d828261520d565b50506000600181905560025550565b600054610100900460ff16613f635760405162461bcd60e51b8152600401610c9390615142565b611c6961409a565b600054610100900460ff16611c695760405162461bcd60e51b8152600401610c9390615142565b6000806000613fa3878787876140ca565b91509150613fb08161418e565b5095945050505050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f613fe56142d8565b613fed614331565b60408051602081019490945283019190915260608201524660808201523060a082015260c00160405160208183030381529060405280519060200120905090565b61403781613e26565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b90600090a250565b6060614093838360405180606001604052806027815260200161533260279139614362565b9392505050565b600054610100900460ff166140c15760405162461bcd60e51b8152600401610c9390615142565b611c6933613c84565b6000807f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a08311156141015750600090506003614185565b6040805160008082526020820180845289905260ff881692820192909252606081018690526080810185905260019060a0016020604051602081039080840390855afa158015614155573d6000803e3d6000fd5b5050604051601f1901519150506001600160a01b03811661417e57600060019250925050614185565b9150600090505b94509492505050565b60008160048111156141a2576141a26152cc565b036141aa5750565b60018160048111156141be576141be6152cc565b0361420b5760405162461bcd60e51b815260206004820152601860248201527f45434453413a20696e76616c6964207369676e617475726500000000000000006044820152606401610c93565b600281600481111561421f5761421f6152cc565b0361426c5760405162461bcd60e51b815260206004820152601f60248201527f45434453413a20696e76616c6964207369676e6174757265206c656e677468006044820152606401610c93565b6003816004811115614280576142806152cc565b036114435760405162461bcd60e51b815260206004820152602260248201527f45434453413a20696e76616c6964207369676e6174757265202773272076616c604482015261756560f01b6064820152608401610c93565b6000806142e3613cd6565b8051909150156142fa578051602090910120919050565b60015480156143095792915050565b7fc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a4709250505090565b60008061433c613d68565b805190915015614353578051602090910120919050565b60025480156143095792915050565b6060600080856001600160a01b03168560405161437f91906152e2565b600060405180830381855af49150503d80600081146143ba576040519150601f19603f3d011682016040523d82523d6000602084013e6143bf565b606091505b50915091506143d0868383876143da565b9695505050505050565b60608315614449578251600003614442576001600160a01b0385163b6144425760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e74726163740000006044820152606401610c93565b50816124ea565b6124ea838381511561445e5781518083602001fd5b8060405162461bcd60e51b8152600401610c9391906152fe565b6001600160a01b038116811461144357600080fd5b60006020828403121561449f57600080fd5b813561409381614478565b600080604083850312156144bd57600080fd5b82356144c881614478565b946020939093013593505050565b6000602082840312156144e857600080fd5b5035919050565b60008083601f84011261450157600080fd5b5081356001600160401b0381111561451857600080fd5b60208301915083602082850101111561453057600080fd5b9250929050565b634e487b7160e01b600052604160045260246000fd5b604051601f8201601f191681016001600160401b038111828210171561457557614575614537565b604052919050565b60ff8116811461144357600080fd5b60006060828403121561459e57600080fd5b604051606081018181106001600160401b03821117156145c0576145c0614537565b60405290508082356145d18161457d565b8082525060208301356020820152604083013560408201525092915050565b600080600080600060c0868803121561460857600080fd5b853561461381614478565b945060208601356001600160401b0381111561462e57600080fd5b61463a888289016144ef565b90955093505060408601359150614654876060880161458c565b90509295509295909350565b6000806020838503121561467357600080fd5b82356001600160401b0381111561468957600080fd5b614695858286016144ef565b90969095509350505050565b60006001600160401b038211156146ba576146ba614537565b50601f01601f191660200190565b600080604083850312156146db57600080fd5b82356146e681614478565b915060208301356001600160401b0381111561470157600080fd5b8301601f8101851361471257600080fd5b8035614725614720826146a1565b61454d565b81815286602083850101111561473a57600080fd5b816020840160208301376000602083830101528093505050509250929050565b60008060008060008060c0878903121561477357600080fd5b863561477e81614478565b9550602087013561478e81614478565b9450604087013561479e81614478565b9350606087013592506080870135915060a08701356147bc81614478565b809150509295509295509295565b801515811461144357600080fd5b600080604083850312156147eb57600080fd5b82356147f681614478565b91506020830135614806816147ca565b809150509250929050565b60005b8381101561482c578181015183820152602001614814565b50506000910152565b6000815180845261484d816020860160208601614811565b601f01601f19169290920160200192915050565b60ff60f81b881681526000602060e08184015261488160e084018a614835565b8381036040850152614893818a614835565b606085018990526001600160a01b038816608086015260a0850187905284810360c0860152855180825283870192509083019060005b818110156148e5578351835292840192918401916001016148c9565b50909c9b505050505050505050505050565b60008060008060a0858703121561490d57600080fd5b84356001600160401b0381111561492357600080fd5b61492f878288016144ef565b90955093505060208501359150614949866040870161458c565b905092959194509250565b60008083601f84011261496657600080fd5b5081356001600160401b0381111561497d57600080fd5b6020830191508360208260051b850101111561453057600080fd5b600082601f8301126149a957600080fd5b813560206001600160401b038211156149c4576149c4614537565b6149d2818360051b0161454d565b828152606092830285018201928282019190878511156149f157600080fd5b8387015b85811015614a1457614a07898261458c565b84529284019281016149f5565b5090979650505050505050565b600080600080600060608688031215614a3957600080fd5b85356001600160401b0380821115614a5057600080fd5b614a5c89838a01614954565b90975095506020880135915080821115614a7557600080fd5b614a8189838a01614954565b90955093506040880135915080821115614a9a57600080fd5b50614aa788828901614998565b9150509295509295909350565b600080600060408486031215614ac957600080fd5b83356001600160401b03811115614adf57600080fd5b614aeb868287016144ef565b909790965060209590950135949350505050565b60008060008060408587031215614b1557600080fd5b84356001600160401b0380821115614b2c57600080fd5b614b3888838901614954565b90965094506020870135915080821115614b5157600080fd5b50614b5e87828801614954565b95989497509550505050565b60008060008060008060808789031215614b8357600080fd5b8635614b8e81614478565b955060208701356001600160401b0380821115614baa57600080fd5b614bb68a838b01614954565b90975095506040890135915080821115614bcf57600080fd5b614bdb8a838b01614954565b90955093506060890135915080821115614bf457600080fd5b50614c0189828a01614998565b9150509295509295509295565b6020808252600490820152635a65726f60e01b604082015260600190565b634e487b7160e01b600052601160045260246000fd5b8181038181111561136157611361614c2c565b808202811582820484141761136157611361614c2c565b8082018082111561136157611361614c2c565b600060208284031215614c9157600080fd5b815161409381614478565b6020808252600890820152674f6e6c792044414f60c01b604082015260600190565b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b6001600160a01b038581168252841660208201526060604082018190526000906143d09083018486614cbe565b6001600160a01b03841681526040602082018190526000906125699083018486614cbe565b6020815260006124ea602083018486614cbe565b600080600080600080600080610100898b031215614d6a57600080fd5b8851975060208901519650604089015195506060890151614d8a81614478565b60808a0151909550614d9b81614478565b60a08a0151909450614dac8161457d565b60c08a0151909350614dbd8161457d565b60e08a0151909250614dce816147ca565b809150509295985092959890939650565b6020808252602c908201527f46756e6374696f6e206d7573742062652063616c6c6564207468726f7567682060408201526b19195b1959d85d1958d85b1b60a21b606082015260800190565b6020808252602c908201527f46756e6374696f6e206d7573742062652063616c6c6564207468726f7567682060408201526b6163746976652070726f787960a01b606082015260800190565b600060208284031215614e8957600080fd5b8151614093816147ca565b6020808252600f908201526e4f6e6c79204b32206c656e64696e6760881b604082015260600190565b6000806000806000806000806000806101408b8d031215614edd57600080fd5b8a51614ee881614478565b60208c0151909a50614ef981614478565b60408c0151909950614f0a81614478565b60608c01519098506001600160401b03811115614f2657600080fd5b8b01601f81018d13614f3757600080fd5b8051614f45614720826146a1565b8181528e6020838501011115614f5a57600080fd5b614f6b826020830160208601614811565b80995050505060808b0151955060a08b0151945060c08b0151935060e08b015192506101008b015191506101208b015190509295989b9194979a5092959850565b634e487b7160e01b600052603260045260246000fd5b6000808335601e19843603018112614fd957600080fd5b8301803591506001600160401b03821115614ff357600080fd5b60200191503681900382131561453057600080fd5b60006001820161501a5761501a614c2c565b5060010190565b8183823760009101908152919050565b602080825260139082015272092dcc6dedce6d2e6e8cadce840d8cadccee8d606b1b604082015260600190565b60006020828403121561507057600080fd5b8135614093816147ca565b6001600160a01b0384168152604060208083018290529082018390526000906060600585901b840181019190840186845b8781101561511b57868503605f190183528135368a9003601e190181126150d257600080fd5b890184810190356001600160401b038111156150ed57600080fd5b8036038213156150fc57600080fd5b615107878284614cbe565b9650505091830191908301906001016150ac565b509298975050505050505050565b60006020828403121561513b57600080fd5b5051919050565b6020808252602b908201527f496e697469616c697a61626c653a20636f6e7472616374206973206e6f74206960408201526a6e697469616c697a696e6760a81b606082015260800190565b600181811c908216806151a157607f821691505b6020821081036151c157634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115611c5257600081815260208120601f850160051c810160208610156151ee5750805b601f850160051c820191505b818110156126f1578281556001016151fa565b81516001600160401b0381111561522657615226614537565b61523a81615234845461518d565b846151c7565b602080601f83116001811461526f57600084156152575750858301515b600019600386901b1c1916600185901b1785556126f1565b600085815260208120601f198616915b8281101561529e5788860151825594840194600190910190840161527f565b50858210156152bc5787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b634e487b7160e01b600052602160045260246000fd5b600082516152f4818460208701614811565b9190910192915050565b602081526000614093602083018461483556fe360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a2646970667358221220a29a551c891c8dcf42d14d90ab7958a1e15cbda4a53ff598b20c3d2d28b5dc1a64736f6c63430008140033"

logging.basicConfig(filename="/tmp/K2_K2NodeOperatorModule_deployment.log",
                    filemode='a',
                    format='%(asctime)s,%(msecs)d %(name)s %(levelname)s %(message)s',
                    datefmt='%H:%M:%S',
                    level=logging.INFO)

def deploy_K2_K2NodeOperatorModule() -> (bool, dict):
    
    result = {
        "transaction": {},
        "receipt": {},
        "additional_info": {
            "contract_address": "" # Only populates if the contract was deployed successfully
        }
    }
    
    el_uri = os.getenv("EL_RPC_URI", 'http://0.0.0.0:53913')
    sender = get_sender()
    receiver = "0x0000000000000000000000000000000000000000"
    w3 = Web3(Web3.HTTPProvider(el_uri))
    # sleep for 10s before checking again
    time.sleep(10)
    
    # Check if the chain has started before submitting transactions
    block = w3.eth.get_block('latest')
    
    logging.info(f"Latest block number: {block.number}")
    if block.number > 1:
        logging.info("Chain has started, proceeding with PoN-K2NodeOperatorModule deployment")
        sender_account = w3.eth.account.from_key(sender)
        
        w3.middleware_onion.add(construct_sign_and_send_raw_middleware(sender_account))
        
        logging.info("Preparing PoN-K2NodeOperatorModule deployment tx")
        transaction = {
            "from": sender_account.address,
            "to": receiver,
            "value": 0,
            "gasPrice": w3.eth.gas_price,
            'nonce': w3.eth.get_transaction_count(sender_account.address),
            "data": BYTE_CODE
        }
        
        logging.info("Estimating gas")
        estimated_gas = w3.eth.estimate_gas(transaction)
        transaction["gas"] = estimated_gas
        
        logging.info("Sending PoN-K2NodeOperatorModule deployment tx")
        logging.debug(f"Sending deployment tx: {transaction}")
        tx_hash = w3.eth.send_transaction(transaction)
        
        time.sleep(10)
        K2NodeOperatorModule_tx = w3.eth.get_transaction(tx_hash)
        K2NodeOperatorModule_receipt = w3.eth.get_transaction_receipt(tx_hash)
        
        logging.info(f"PoN-K2NodeOperatorModule deployment tx: {K2NodeOperatorModule_tx}")
        logging.info(f"PoN-K2NodeOperatorModule deployment receipt: {K2NodeOperatorModule_receipt}")
        
        if K2NodeOperatorModule_receipt['status'] == 1:
            logging.info("PoN-K2NodeOperatorModule deployment successful")
            result["transaction"] = K2NodeOperatorModule_tx
            result["receipt"] = K2NodeOperatorModule_receipt
            result["additional_info"]["contract_address"] = K2NodeOperatorModule_receipt["contractAddress"]
            return True, result
        else:
            logging.info("PoN-K2NodeOperatorModule deployment failed")
            return False, result
        
    else:
        logging.info("Chain has not started, restarting deployment")
        return False, {}

def get_sender() -> str:
    # Extract the right private key from the list of private keys
    private_keys = os.getenv("PRIVATE_KEYS", ACCOUNT_ALIAS+":ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80")
    private_keys.split(";")
    sender = ""
    for key in private_keys:
        if key.split(":")[0] == ACCOUNT_ALIAS:
            sender_keys = key.split(":")[1].split(",")
            sender = sender_keys[0]
            break
    return sender

def run_till_deployed() -> dict:
    deployment_status = False
    deployment_details = {}
    while deployment_status is False:
        try:
          deployment_status, deployment_details = deploy_K2_K2NodeOperatorModule()
        except Exception as e:
          logging.error(e)
          logging.error("restarting deployment as previous one failed")
    
    return deployment_details


if __name__ == "__main__":
    
    logging.info("PoN-K2NodeOperatorModule deployment started")
    deployment_details = run_till_deployed()
    logging.info("PoN-K2NodeOperatorModule deployment finished")
    
    print(deployment_details)
